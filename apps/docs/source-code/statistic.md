## Statistics

统计函数用于改变几何元素的位置或颜色

修改几何元素的位置就意味着修改或者产生新位置通道的值，也就是几何图形里面提到的 x、x1、y、y1 这些通道的值。这也是为什么统计函数的名字是由 X 和 Y 结尾：X 说明该函数修改了该几何图形 x 通道的值，Y 说明该函数修改了该几何图形 x 通道的值。

### 堆叠

统计函数处理的数据不是我们的原始表格数据，而是一个和每个通道绑定的对象，参考下面的例子

```javascript
// 在 x = 0 的位置堆叠，y 为每一个种类占的值
const raw = [
  { x: 0, y: 1 },
  { x: 0, y: 2 },
  { x: 0, y: 3 },
];

// 和每个通道绑定的对象
const data = {
  index: [0, 1, 2], // 三个几何图形
  values: {
    x: [0, 0, 0],
    y: [1, 2, 3],
  },
};
```

### 归一化

归一化其实就是把 y 通道的值都变成了 [0, 1] 这个范围之内。常用于百分比条形图

```javascript
import { createNormalizeY } from "../../src/statistic";
const data = {
  index: [0, 1, 2],
  values: {
    x: [0, 1, 2],
    y1: [2, 4, 6], // 从小到大，表示到零坐标的距离
    y: [10, 10, 10],
  },
};
const normalizeY = createNormalizeY();
// {
//   index: [0, 1, 2],
//   values: {
//     x: [0, 1, 2],
//     y1: [0.2, 0.4, 0.6],
//     y: [1, 1, 1],
//   },
// }
```

### 对称

对称通常用于河流图或漏斗图

#### 河流图

河流图的流向为 x 轴，而河流的宽度表示数值，其中心轴与 x 轴平行，每个不同的类别都会汇成一条河流

#### 计算方式

1. 先要算出每个 x 通道下，所有 y 通道中，最大的 y 通道的平均值
2. 然后每个 x 通道上的 y 通道根据 该平均值 重新计算，在保持每个 y 通道值之间的间距相同的情况下，确保所有 y 通道的平均值为最大的平均值

### 分箱 BinX

分箱用于对 X 通道进行分组，主要用于直方图，用于将 X 通道重新修改成一个一个范围区间，新增了 X1 通道

```javascript
import { createBinX } from "../../src/statistic";
const data = {
  index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
  values: {
    x: [3, 6, 7, 12, 13, 12, 13, 13, 16, 17, 18, 23, 33, 30],
    y: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  },
};

const binX = createBinX({ channel: "fill" });
binX(data);
// {
//   index: [0, 1, 2, 3, 4, 6],
//   values: {
//     x: [0, 5, 10, 15, 20, 25, 30],
//     x1: [5, 10, 15, 20, 25, 30, 35],
//     fill: [1, 2, 5, 3, 1, 0, 1],
//     y: [1, 1, 1, 1, 1, undefined, 1],
//   },
// }
```
